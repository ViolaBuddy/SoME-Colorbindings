<!DOCTYPE html>
<meta charset="UTF-8">
<html>
<head>
	<title>Colorbindings of Chess Variant Pieces</title>
	<link rel="stylesheet" type="text/css" href="indexstyle.css">
	<script type="text/javascript" id="MathJax-script" async
		src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
	</script>
	<script type="text/javascript" src="chess-pieces.js"></script>
	<script type="text/javascript" src="list-of-chess-pieces.js"></script>
	<script type="text/javascript" src="index.js"></script>
</head>
<body>
<div id="left">
	<div id="boardPieceDetails">
		<h3 id="boardPieceName">Pawn</h3>
		<details>
			<summary>Details about this piece</summary>
			<p id="boardPieceDescription"></p>
		</details>
		<button id="reset_position">Reset Position</button>
	</div>
	<div id="boarddivwrapper">
		<div id="boarddiv"></div>
	</div>
	<fieldset id="boarddivcontrols">
		<legend>Chessboard Controls</legend>
		<input type="radio" id="coloring_checkerboard" name="board_coloring" value="coloring_checkerboard" checked="on" /> <label for="coloring_checkerboard">Show standard checkerboard coloring</label><br />
		<input type="radio" id="coloring_colorbinding" name="board_coloring" value="coloring_colorbinding" /> <label for="coloring_colorbinding">Show colorbinding of current piece</label><br />
		<input type="radio" id="coloring_none" name="board_coloring" value="coloring_none" /> <label for="coloring_none">Show no coloring</label>

		<div id="choose_piece">Choose piece:
			<details>
				<summary>Western Chess</summary>
				Standard international chess. The oldest known version was chaturanga, from India under the Gupta Empire in the 600s, before spreading westward through Persia, Arabia, and Europe in the middle ages.<br/>
				<button class='pawn'>Pawn</button>
				<button class='knight'>Knight</button>
				<button class='bishop'>Bishop</button>
				<button class='rook'>Rook</button>
				<button class='queen'>Queen</button>
				<button class='king'>King</button>
			</details>

			<details>
				<summary>Xiangqi (象棋)</summary>
				Chinese chess. The game clearly is related to chaturanga, but it's unclear whether (proto-)xiangqi or chaturanga came first, and different sources online say different things. Unlike Western chess, pieces are placed on the intersections of lines, rather than on the squares outlined by the lines, but for the purposes of this page, I standardize everything to be on the squares.<br/>
				<button class='pawn'>Pawn (Soldier)</button>
				<button class='promotedsoldier'>Promoted Pawn (Promoted Soldier)</button>
				<button class='rook'>Rook (Chariot)</button>
				<button class='knight'>Knight (Horse)</button>
				<button class='alfil'>Alfil (Elephant)</button>
				<button class='ferz'>Ferz (Advisor)</button>
				<button class='wazir'>Wazir (General/King)</button>
				<button class='rook'>Cannon</button>
			</details>

			<details>
				<summary>Shōgi (将棋)</summary>
				Japanese chess. The oldest known version, Heian shōgi, is from, well, the Heian period, between the 9th and 12th centuries, but it kept evolving over the next few centuries when it took its modern form in the 1500s. Heian shōgi had developed out of some sort of chess brought to Japan from overseas.<br/>
				<button class='pawn'>Pawn (Soldier)</button>
				<button class='lance'>Lance (Fragrant Chariot)</button>
				<button class='laurelhorse'>Laurel Horse</button>
				<button class='silvergeneral'>Silver General</button>
				<button class='goldgeneral'>Gold General</button>
				<button class='bishop'>Bishop (Angle Mover)</button>
				<button class='rook'>Rook (Flying Dragon)</button>
				<button class='dragonhorse'>Dragon Horse (Promoted Bishop)</button>
				<button class='dragonking'>Dragon King (Promoted Rook)</button>
				<button class='king'>King</button>
			</details>

			<details>
				<summary>Other Chess Variants</summary>
				There are a few other pieces from chess variants with well-established names, especially if they were in one of the most historically significant versions and variations of chess. Chaturanga was already mentioned in the Western Chess section, but other important historical chess variants include Tamerlane Chess from the Timurid Empire (1300s Persia and India), and Courier Chess from medieval Germany (1200s)&mdash;along with, of course, modern chess variant communities.<br />
				<button class='wazir'>Wazir</button>
				<button class='ferz'>Ferz</button>
				<button class='dabbaaba'>Dabbaaba</button>
				<button class='alfil'>Alfil</button>
				<button class='narrowknight'>Narrow Knight</button>
				<button class='wideknight'>Wide Knight</button>
				<button class='camel'>Camel</button>
				<button class='threeleaper'>Threeleaper</button>
				<button class='dabbaabarider'>Dabbaaba-rider</button>
				<button class='alfilrider'>Alfil-rider</button>
				<button class='nightrider'>Nightrider</button>
				<button class='camelrider'>Camelrider</button>
			</details>

			<details>
				<summary>Custom</summary>
				The main article in the right gives you a few places to create custom pieces. Here are links to jump to those places.
				<ul>
					<li><a href="#custom_symmetric">Jump to custom symmetric piece input</a></li>
					<li><a href="#custom_reduce">Jump to custom symmetric piece input with reduction algorithm</a></li>
					<li><a href="#custom_asymmetric">Jump to custom asymmetric piece input</a></li>
				</ul>
			</details>
		</div>


		<label for="board_size_input">Board size: <span id="board_size_output">11</span></label> <input type="range" min="1" max="32" value="13" step="1" class="slider" id="board_size_input"><br/>
		(Note: changing board size resets the piece back to Pawn)<br />
	</fieldset>
</div>
<div id="right">
	<h1>Colorbindings of Chess Variant Pieces</h1>
	<div class="content">
		<h2>Introduction</h2>
		<p>Chess is played by moving pieces around on a square grid. And this is true of xiangqi (Chinese chess) and shōgi (Japanese chess) too. And sure there's, like, strategy and stuff, but we can skip that part today. Let's just talk about moving pieces.</p>
		<p>Each chess piece can move in its own unique way. For examples, knights move in a distinctive L-shaped way.  Despite this strange movement, knights can actually reach any square on the board, which I will state without proof here, but you can try it for yourself! If you press this button <button class='knight'>Knight</button>, in the left panel the piece will update to have a knight's movement (the piece's image will not change). Gray squares are where you can move; click on them to move there.</p>
		<p>But not all pieces can do that. Obviously, the pawn, which can only move forward, cannot reach squares behind it. There are some similar forward-only pieces from xiangqi and shōgi, too. But, also, there's the bishop, which can only reach half the squares on the board&mdash;try it out and you'll immediately see why. <button class='pawn'>Pawn</button> <button class='promotedsoldier'>Promoted Soldier (Xiangqi)</button> <button class='lance'>Lance</button> <button class='laurelhorse'>Laurel Horse</button> <button class='bishop'>Bishop</button></p>
		<p>So today I'd like to explore this idea of pieces being only able to move to certain squares. And by "today" I mean "I've been thinking about this for many, many years now." As a child, I was very into chess variants, perusing the pages of <a href="https://www.chessvariants.com">chessvariants.com</a> and thinking about funny new pieces and how they might move. And this idea of being stuck on certain squares is a common idea among chess variant pieces (also called "fairy chess pieces"). This idea is generally called being <strong>colorbound</strong>, named after the fact that on an ordinary chessboard, the bishop that starts on one color is stuck to that color and will never leave it.</p>
		<p>But it turns out that you can construct other pieces (like the alfil <button class='alfil'>Alfil</button>) that have can reach a set of squares other than just "the light squares" and "the dark squares." I will still call this set of reachable squares a "colorbinding" even if a normal chessboard isn't colored that way. In "Chessboard Controls" at the bottom of the left panel, you can choose to color the board according to the current piece's colorbinding, or to leave the board uncolored.</p>
		<p>Since there's more than one way to be colorbound, a very natural question to ask is: <strong>what are all the ways that a piece can be colorbound?</strong> As a ten-year-old, I never got very far with this question, but now, nearly two decades later, let's see if we can't do a bit better.</p>
	</div>
	<div class="content">
		<h2>Let's start with some terms and conditions</h2>
		<p>First of all, what can a chess variant piece be? People have done really wild and creative things with their chess variants. For example, you could arbitrarily choose a set of squares on the board and be like "Well, my new piece, the gobbledygook, can teleport between any of those squares." But if we allowed that sort of piece, then all possible ways of being colorbound is, trivially, possible, by just declaring any arbitrary set of squares for the gobbledygook.</p>
		<p>Instead, we can think back to the pieces from the three "canonical" types of chess I mentioned before. In almost all cases, the pieces' movements have translational symmetry: no matter where you are on the board, you can move to the same squares relative to yourself. So for our exploration today, let us only consider pieces whose movements are translationally symmetric.</p>
		<p>We do have to qualify this a little bit. Let's ignore the fact that you're not allowed to move off the edge of a board&mdash;that is, let's consider an infinite board. (In the left panel, we have a finite-sized board, but you can resize it if you're running into too many edge effects.) Let's also assume that no other pieces are on this infinite board&mdash;pawns can't move diagonally to capture, rooks and xiangqi horses aren't blocked by pieces in the way, etc.</p>
		<p>Even under these conditions, there are actually still a few pieces in the three canonical types of chess that are not translationally symmetric. One is the pawn in Western chess: if it's on the second row ("rank" in chess terms, but I never remember which is rank and which is file), it has the additional move of moving two squares forward. Others are from xiangqi: the general and advisors can only move within the 3&times;3 palace, and the elephants cannot cross the river that divides the xiangqi board in half. So, again, we're just going to ignore any pieces with these sorts of location restrictions.</p>
		<p>Out of the remaining pieces, we can split their movements into two types: <strong>leapers</strong> and <strong>riders</strong>. Leapers like simply jump to a square a certain offset away from the starting square. Knights and kings are leapers <button class='knight'>Knight</button> <button class='king'>King</button>. Riders start like leapers jumping to a square a certain offset away, but then are allowed to continue in that direction for as long as they like (we're on an empty infinite board, remember). Rooks and queens are riders <button class='rook'>Rook</button> <button class='queen'>Queen</button>. In fact, we can phrase it as "a queen is a king-rider" to denote that a queen has the same basic movement as the king but can continue riding in the same direction as a single move.</p>
		<p>A leaper and its corresponding rider have the same colorbinding (i.e. they can reach the same set of squares). I state this without proof beyond "it's obvious" in the annoying way that you always find in math. But I'll at least leave you with an example: try playing around with an Alfil and an Alfil-rider: <button class='alfil'>Alfil</button> <button class='alfilrider'>Alfil-rider</button>. Because of this, we can without loss of generality consider only leapers.</p>
		<p>(As an irrelevant aside: you can actually combine leapers and riders, so that you're a rider in some directions and a leaper in others, like the dragon king and dragon horse in shōgi.) <button class='dragonking'>Dragon King</button> <button class='dragonhorse'>Dragon Horse</button></p>
		<p>We can describe a leaper as a set of moves that it can make. A knight is a <span class="mathjaxcontent">$\left\{(1,2), (1,-2), (-1,-2), (-1,2), (2,1), (2,-1), (-2,-1), (-2,1)\right\}$ leaper. A white pawn (without its double move or capture moves) is a $\{(0,1)\}$</span> leaper, and a black pawn, which moves the other way, is a $\{(0,-1)\}$</span> leaper.</p>
		<p>On that note: rather than the standard letter-and-number system that chess uses for labeling each square on the chessboard, for our infinite chessboard, I'm labeling them $(x,y)$, like the Cartesian plane. And like the Cartesian plane, the positive x-axis is to the right and the positive y-axis is to the top. Unlike the Cartesian plane, we only have integers, none of the in-between fractions or reals.</p>
		<p>For consistency, let's consider the colorbindings of pieces that start on the origin square, i.e. square $(0,0)$, colored green in the left panel.</p>
	</div>

	<div class="content">
		<h2>I smell group theory</h2>
		<p>So where do we begin? As a kid there were a lot of ways I tried to think about this, but group theory was not one of them. Because that's not a thing you learn as a kid. But now, years later, having had an admittedly extremely fast crash course on the subject as part of another class, I'm definitely feeling group theory vibes from this question. If we set things up right, maybe we can just nab some ideas from group theory to answer our question.</p>
		<p>So let's start by defining some key ideas. A <strong>group</strong> is a set of things and an operation. Which sounds very vague but that's why it's so applicable to so many things. In this case, we have a set of squares on the board, and each given piece tells you some ways you can move between the squares, which feels close enough to being an operation. Is that good enough to be a group?</p>
		<p>Well, you do need a couple properties to hold before you're really be considered a group. Let's start from an easier-to-understand example: the additive group of integers. This is the set of things is all integers $\mathbb{Z}$, with the operation of addition $+$. The four required properties of groups are:</p>
		<ol>
			<li>The group must be <strong>closed</strong> under the operation. For all elements $a$ and $b$, $a+b$ must also be part of the group. So, like, if you add $3$ and $8$ you'll get another integer; you'll never get something that's not an integer.</li>
			<li>There must be an <strong>identity</strong> element $e$ such that any element $x+e=x$ and $e+x=x$. For addition, our identity element is zero. If you add zero to any integer, you'll get that same integer back.</li>
			<li>For every element $x$ there must be an <strong>inverse</strong> element $x_{inverse}$ such that $x + x_{inverse}=e$. For addition, that's the negative of a number. $3$ is an integer, so $-3$ must also be an integer, and $3 + -3$ must equal $0$.</li>
			<li>The operation must be <strong>associative</strong>. $(a+b)+c = a+(b+c)$. This is obviously true for addition; for example, $(3+4)+9$ and $3+(4+9)$ both equal $16$.</li>
		</ol>
		<p>If you're familiar with the formal properties of addition, there's one property that you've probably noticed is missing from the list: <strong>commutivity</strong>, which is the ability to reorder the arguments. So $4 + 8$ is the same as $8 + 4$. Addition of integers is indeed commutative, but it's not necessary to be classified as a group.</p>
		<p>So back to our "chess board and piece movement" systems. Do these form a group? Well, the way we've numbered the squares as $(x,y)$ suggests that we're actually just dealing with the cross product of the integers with themselves, $\mathbb{Z} \times \mathbb{Z}$, i.e. the set of all ordered pairs of integers.</p>
		<p>(Before group theory fans start coming after me&mdash;technically, when talking about groups and not just sets, we generally call these paired-up groups <strong>direct products</strong>, rather than cross products.)</p>
		<p>And not only are squares elements of this set&mdash;each movement for a piece, like $(2,1)$ for a knight, is an element of it, too! That's good, because then we can define our operation (which we handwaved earlier as "a piece movement-ish thing") more precisely as putting together two elements of our set, one of which we think of as a square and one of which we think of as our movement.</p>
		<p>And it gets better&mdash;when we say "put together" what we mean by that is that it's just plain integer addition, just on each axis separately. For example, if you start from the $(3,5)$ square and make the $(2,1)$ move, you'll end up on the $(3,5) + (2,1) = (5,6)$ square. And we just showed that the integers are a group under regular old addition! So we're basically inheriting these four properties of groups from the fact that we're just a cross product of two groups.</p>
		<p>So we have this mathematical setup for the board. Great. But the thing in particular that we were trying to think about were colorbindings; how does that translate into group theory language? Well, since a colorbinding is the set of a piece's <em>accessible</em> squares, obviously it's a subset of <em>all</em> squares, which we just said is $\mathbb{Z} \times \mathbb{Z}$. And further, our concept of a movement set of a piece corresponds with the idea of a <strong>generating set</strong>: a set $M$ is said to generate another set $X$ if all elements of $X$ can be expressed as combinations of repeated applications of (possibly different) elements of $M$. So exactly the relationship between a movement set and a colorbinding.</p>
		<p>Some group theory fans are probably complaining again because usually when we're talking about generating sets we're talking not about any old subset of a group, but a special kind of subset of a group called a <strong>subgroup</strong>. A subgroup is exactly what it sounds like, subsets that are themselves groups. So are colorbindings subgroups of $\mathbb Z \times \mathbb Z$? We just have to check the properties above. Associativity comes for free because that's a property of the operation part of the group, not the set part. So we only have to check the other three properties:</p>
		<ol>
			<li><strong>Closure:</strong> Remember our definition for this: for all elements $a$ and $b$, $a+b$ must also be part of the group. So consider a square $b$ that you can reach in some number of moves. If you do that sequence of moves but start from square $a$ (instead of the origin square), that would be $a+b$. Is this final destination part of the original group? Well, yes, by our original definition. It's an accessible square because you just accessed it, starting from the origin.</li>
			<li><strong>Identity:</strong> The identity for our $+$ operation on $\mathbb{Z} \times \mathbb{Z}$ is the $(0,0)$ origin square. You start out standing on it, so you've accessed it. Therefore it's in our colorbinding.</li>
			<li><strong>Inverse:</strong> That is, if you travel out from the origin to some other square A, you can always find a path all the way back to the origin. But&hellip; that's not actually true. Remember the pawn? You can't undo its moves!</li>
		</ol>
		<p>So in fact, no, a colorbinding of an arbitrary piece isn't a subgroup. Welp. Still, almost-groups that don't have inverses are called <strong>monoids</strong>, and even though they're not quite as well-studied as groups, they're well-studied enough to have a name, at least.</p>
		<p>So now we can do two things: (1) ignore pieces that don't have inverses, or (2) see what we can do even though it's not a group&mdash;and in fact, we'll do both, starting with the first.</p>
	</div>

	<div class="content">
		<h2>Keeping things easy: symmetric pieces</h2>
		<p>When talking about a generating set $\{a, b, c, \ldots\}$ of a <em>subgroup</em>, we allow not only repeated applications of $a$, $b$, $c$, etc., but also $a_{inverse}$, $b_{inverse}$, $c_{inverse}$, etc. This makes the third "Inverse" property of groups automatically satisfied, no matter what the generating set was.</p>
		<p>So for our case, this kind of generating set corresponds to the movement set of something that we can call a <strong>symmetric piece</strong>. That is, a piece whose movements come in pairs: for every move (x,y) that it can make, it can also make the move (-x,-y). As such, when listing out the moves of a symmetric piece, we don't need to write the inverse move: a knight is a $\{(1,2),(2,1),(-1,2),(-2,1)\}$ symmetric piece; the other four moves are automatically included. <button class='knight'>Knight</button></p>
		<p>Before we dive too deep into the math, let's just play around with some examples. All five non-pawn pieces in Western chess are symmetric. Shōgi, on the other hand, has a lot of asymmetric pieces: the lance and laurel horse, as mentioned earlier, are forward-only, but the gold and silver generals are also asymmetric. <button class='lance'>Lance</button> <button class='laurelhorse'>Laurel Horse</button> <button class='goldgeneral'>Gold General</button> <button class='silvergeneral'>Silver General</button></p>
		<p>Now let's look at the colorbindings for the dabbaaba and the alfil: <button class='dabbaaba'>Dabbaaba</button> <button class='alfil'>Alfil</button>. They're kind of just kind of grid-ish, lines running at right angles to each other. Do all symmetric pieces have this square grid shape to their colorbindings?</p>
		<p>Well, no. It doesn't have to be square because the side lengths don't have to be the same. A piece that's a dabbaaba horizontally but a threeleaper vertically would have a rectangular grid, rather than a square one (I'll use <a href="https://www.chessvariants.com/d.betza/chessvar/pieces/notation.html">Ralph Betza's funny notation</a> for naming this more exotic piece without a standard name: <button class='fbHsD'>fbHsD</button>). But even more, the pieces we've been considering all lie on an axis of symmetry of the plane. If you take moves on a different angle, the grid lines skew away from perpendicular to each other, to form a parallelogram. Consider the narrow knight, which is the symmetric extension of shōgi's laurel horse: <button class='narrowknight'>Narrow Knight</button> <button id='narrowknightparallelogram'>Show/Hide Parallelogram</button>.</p>
		<p>To some extent, this actually feels pretty natural. All these pieces we've looked at here have two moves in their symmetric movement set. So there are two axes of movement, one for each of these moves. As long as the two moves aren't parallel, of course we're going to end up with some sort of grid like this.</p>
		<p>So what happens if we add a third move to our movement set? Can we get something more interesting with three moves? Well, try it yourself to see what you can come up with:</p>
		<p id="custom_symmetric">
			<!-- 9007199254740992 is the maximum integer that can be stored as a Javascript Number (a double) without losing precision when you do arithmetic on it: the next storable number is 9007199254740994, skipping over 9007199254740993 -->
			$\{($
			<input type="number" id="customthreemove_11" min="-9007199254740992" max="9007199254740992" value="1" autocomplete="off"/>
			$,$
			<input type="number" id="customthreemove_12" min="-9007199254740992" max="9007199254740992" value="2" autocomplete="off"/>
			$),$
			<br>
			$($
			<input type="number" id="customthreemove_21" min="-9007199254740992" max="9007199254740992" value="-1" autocomplete="off"/>
			$,$
			<input type="number" id="customthreemove_22" min="-9007199254740992" max="9007199254740992" value="2" autocomplete="off"/>
			$),$
			<br>
			$($
			<input type="number" id="customthreemove_31" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			$,$
			<input type="number" id="customthreemove_32" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			$)\}$
			<br>
		 	<button id="customthreemove">Custom Piece</button>
		</p>
		<p id="customthreemove_output"></p>
		<p>I don't know exactly what you came up with, but you probably had coming up with anything that wasn't a parallelogram grid of some kind&mdash;with the pattern maybe messing up at the corners or edges of the board. In fact, that's true. For all symmetric pieces, there always exists some other symmetric piece with at most two moves (and their inverses) with the same colorbinding.</p>
		<p>How can we prove this? Well, we can actually take a page out of linear algebra. Anyone who's familiar with linear algebra may have already felt the similarity&mdash;it feels like we're in a 2D vector space and we're trying to find the span of vectors. It's just that we now live in a quantized integer world, not one with coordinates that can freely vary through all real numbers. But if you're not familiar with linear algebra, that's okay too; we're going to go through this together.</p>
	</div>

	<div class="content">
		<h2>Some almost linear algebra via some actual number theory</h2>
		<p>So we're starting with a symmetric piece $\{a, b, c\}$, and we want to "reduce" it to another piece $\{m, n\}$ that has the same colorbinding, but only two moves in its moveset. Let's use $\{(3,2), (4,3), (5,1)\}$ as our example. <button class='example1'>Example symmetric piece $\{(3,2),(4,3),(5,1)\}$</button></p>
		<p>We can start by observing that if a piece $\{a, b, c\}$ generates a colorbinding, then the piece $\{a, b, c+a\}$ also generates the same colorbinding. In particular, consider any square in the colorbinding that we can get to with the first piece through some path that includes the move $c$. With our new piece, instead of $c$, we can add $c+a$ and then $-a$ to replace it, and we would end up in the same place. Thus, if we could find a path to a square with our first piece, we can also find a path to our second square. And the converse is also true; anywhere our second piece can go to, if it involves $c+a$ we can replace that with $c$ and then $a$, and our first piece can go there too.</p>
		<p>We can of course extend this to say that all of the following have the same colorbinding: $\{a, b, c+b\}$, $\{a, b, c-a\}$, $\{a, b, c+2a\}$, $\{a+c, b, c\}$. That is, we can add any multiple of one movement in our movement set to any other movement, and we would still get the same colorbinding. And we can compose this: first you might add the first move to the third, and then you might subtract this new third from the second, and then you might subtract that all from the first.</p>
		<p>Unlike with vectors, you cannot add a movement <em>to itself</em>. When we added $a$ to another vector $c$, we required that the original $a$ stay intact, so that we can use it to "undo" that addition later. But if you add $a$ to itself, you end up destroying the original copy of $a$. Anecdotally, we've already seen this&mdash;a dabbaaba and a wazir have different colorbindings, even though a dabbaaba's move is just twice a wazir's move! <button class='dabbaaba'>Dabbaaba</button> <button class='wazir'>Wazir</button></p>
		<p>Great, so we have a way to transform pieces with three moves into other pieces with three moves, all while keeping the colorbinding the same. But do you see how we could use this to <em>reduce</em> the number of moves to two? Well, if $(0,0)$, the identity element, is one of the three moves, we can remove it and it wouldn't change the colorbinding. After all, it can never add any new squares no matter how many times you repeat that move.</p>
		<p>So our plan is to figure out a way to do this "adding moves to each other" thing repeatedly until we can get one of the moves to the zero move. So, back to our example piece. For convenience, let's throw the moves into a matrix, one on each row. So in our original example $\{(3,2),(4,3),(5,1)\}$, we start with the following matrix: $$\begin{bmatrix}
			3 & 2\\
			4 & 3\\
			5 & 1
		\end{bmatrix}$$</p>
		<p>What we're doing is a process from linear algebra called <strong>Gaussian elimination</strong> to make this matrix into <strong>row echelon form</strong>. This means each row in the matrix has strictly more zeros at the start of it than the row above it (exception: you're allowed to have the same number of zeros as the row above you if the entire row is already zeros). For example, the following matrices are all in row echelon form: $$\begin{bmatrix}
			4 & 1 \\
			0 & -9\\
			0 & 0
		\end{bmatrix}, \begin{bmatrix}
			4 & 1 \\
			0 & 0\\
			0 & 0
		\end{bmatrix}, \begin{bmatrix}
			4 & 1 & 0\\
			0 & 2 & 2\\
			0 & 0 & 4
		\end{bmatrix}, \begin{bmatrix}
			4 & 1 & 0\\
			0 & 0 & 2\\
			0 & 0 & 0\\
			0 & 0 & 0
		\end{bmatrix}$$</p>
		<p>You can see why this is useful for us: in row echelon form, if each row has to have strictly more zeros than the row above it, then at some point you run out of columns to have zeros in and you have to be all zeros, which is what we're looking for!</p>
		<p>In linear algebra, it's easy to add something to the second and third row to get zero in the first column, because you can multiply by any number. And likewise for getting a zero in the the second column of the third row. So for example, if we pretend our matrix is from ordinary linear algebra land (i.e. each row vector is in $\mathbb R \times \mathbb R$), we could do:$$\begin{aligned}
		\begin{bmatrix}
			3 & 2\\
			4 & 3\\
			5 & 1
		\end{bmatrix}\xrightarrow{\text{add}\left(\frac{-4}{3}\times\text{row 1}\right) \text{ to row 2}}&\begin{bmatrix}
			3 & 2\\
			4-4 & 3 - \frac{8}{3}\\
			5 & 1
		\end{bmatrix} = \begin{bmatrix}
			3 & 2\\
			0 & \frac{1}{3}\\
			5 & 1
		\end{bmatrix}\\
		\xrightarrow{\text{add}\left(\frac{-5}{3}\times\text{row 1}\right) \text{ to row 3}}&\begin{bmatrix}
			3 & 2\\
			0 & \frac{1}{3}\\
			5 - 5 & 1 - \frac{10}{3}
		\end{bmatrix} = \begin{bmatrix}
			3 & 2\\
			0 & \frac{1}{3}\\
			0 & -\frac{7}{3}
		\end{bmatrix}\\
		\xrightarrow{\text{add}\left(7\times\text{row 2}\right) \text{ to row 3}}&\begin{bmatrix}
			3 & 2\\
			0 & \frac{1}{3}\\
			0 & \frac{7}{3} - \frac{7}{3}
		\end{bmatrix} = \begin{bmatrix}
			3 & 2\\
			0 & \frac{1}{3}\\
			0 & 0
		\end{bmatrix}
		\end{aligned}$$ </p>
		<p>But again, for our actual matrix we're stuck with integers, so we can't just multiply by fractions like this. We have to find our zeros a different way.</p>
		<p>This actually stumped me for a little bit, but it turns out that there's an algorithm from number theory that does exactly what we're looking for, reduce a number down to zero by adding and subtracting back and forth. So now that we've touched on group theory and linear algebra, it's time to add a third area of math to this, number theory.</p>
		<p>The reason why I didn't realize this was what I was looking for at first is that this algorithm isn't normally thought of as "a thing that brings a number down to zero." It spits out two numbers, one of which is zero, but the other number is the GCF (greatest common factor) between the two original natural numbers, and of course that part is usually a lot more useful than "a number that is always zero." It's called <strong>Euclid's algorithm</strong>, and is extremely simple: if you have two numbers, subtract the smaller one from the larger one and repeat until one of them is zero. The other number remaining will be the GCF (I won't explain why because it's not relevant to us now, but <a href="https://www.khanacademy.org/computing/computer-science/cryptography/modarithmetic/a/the-euclidean-algorithm">here</a> is an article from Khan Academy about it).</p>
		<p>There's a further modification, in that we're doing this on rows with two numbers each. We're doing Euclid's algorithm on the numbers in the first column, and the second column is just coming along for the ride. An example will probably make that clear:$$\begin{aligned}
		\begin{bmatrix}
			3 & 2\\
			4 & 3\\
			5 & 1
		\end{bmatrix}\xrightarrow{\text{subtract row 1 from row 2}} &\begin{bmatrix}
			3 & 2\\
			4-3 & 3-2\\
			5 & 1
		\end{bmatrix} = \begin{bmatrix}
			3 & 2\\
			1 & 1\\
			5 & 1
		\end{bmatrix}\\
		\xrightarrow{\text{subtract row 2 from row 1, three times}} &\begin{bmatrix}
			3-3 & 2-3\\
			1 & 1\\
			5 & 1
		\end{bmatrix} = \begin{bmatrix}
			0 & -1\\
			1 & 1\\
			5 & 1
		\end{bmatrix}
		\end{aligned}$$</p>
		<p>And we actually ended up with the zero in the top row rather than in the second row. Euclid's algorithm makes no guarantee which of the two rows will end up as zero, only that one of them will. But remember, our matrix is just our movement set, thrown in in any which order; we can always swap rows around because it's not like our $(0,1)$ move has any sort of priority over our $(1,1)$ move. So let's do that, and then repeat Euclid's algorithm between our first and third rows to get one of them down to zero (which happens very quickly this time, in one step):$$\begin{aligned}
		\begin{bmatrix}
			0 & -1\\
			1 & 1\\
			5 & 1
		\end{bmatrix}\xrightarrow{\text{swap rows 1 and 2}} &\begin{bmatrix}
			1 & 1\\
			0 & -1\\
			5 & 1
		\end{bmatrix}\\
		\xrightarrow{\text{subtract row 1 from row 3, five times}} &\begin{bmatrix}
			1 & 1\\
			0 & -1\\
			5-5 & 1-5
		\end{bmatrix} = \begin{bmatrix}
			1 & 1\\
			0 & -1\\
			0 & -4
		\end{bmatrix}
		\end{aligned}$$</p>
		<p>At this point it's pretty obvious that you can move to square $(0, -4)$ using only $(0,-1)$ moves, but just to be systematic about this, we can repeat Euclid's algorithm on the second column of rows 2 and 3 to get a zero. Euclid's algorithm only works on positive integers, but that's okay because we're still working with symmetric pieces right now, so we can invert any row.$$\begin{aligned}
		\begin{bmatrix}
			1 & 1\\
			0 & -1\\
			0 & -4
		\end{bmatrix}\xrightarrow{\text{invert row 2}} &\begin{bmatrix}
			1 & 1\\
			0 & 1\\
			0 & -4
		\end{bmatrix}\\
		\xrightarrow{\text{invert row 3}} &\begin{bmatrix}
			1 & 1\\
			0 & 1\\
			0 & 4
		\end{bmatrix}\\
		\xrightarrow{\text{subtract row 2 from row 3, four times}} &\begin{bmatrix}
			1 & 1\\
			0 & 1\\
			0 & 4-4
		\end{bmatrix} = \begin{bmatrix}
			1 & 1\\
			0 & 1\\
			0 & 0
		\end{bmatrix}
		\end{aligned}$$</p>
		<p>And there we have it. Our original piece with a symmetric movement set of $\{(3,2),(4,3),(5,1)\}$ has the same colorbinding as a piece with a symmetric movement set of $\{(1,1),(0,1),(0,0)\}$, and as we said, we can always remove $(0,0)$ from a movement set, so we can get $\{(1,1),(0,1)\}$. <button class='example1'>Example symmetric piece $\{(3,2),(4,3),(5,1)\}$</button> <button class='reducedexample1'>Reduced example piece $\{(1,1),(0,1)\}$</button>. (Please note that with this example, if you're looking at the "show colorbinding of current piece" view, we run into edge effects in the corners of a finite board where these awkward movements get caught. On an infinite board, we would be able to reach all squares with both pieces.)</p>
		<p>There was nothing special about our original piece here. Any symmetric leaper with more than two movements in its movement set can be reduced in the same way down to something with at most two movements. And pieces with two moves in their movement sets have a grid-like colorbinding, as we saw. So <strong>all symmetric leapers have colorbindings that are parallelogram grids</strong>. Well, actually, some pieces may end up reducing down to a piece with only one movement, which would give you just a line, which is a sort of degenerate parallelogram grid in that case. But I'll let you play around with that here, with a calculator for symmetric pieces with up to four moves:</p>
		<p id="custom_reduce">
			<input type="number" id="symmetric_11" min="-9007199254740992" max="9007199254740992" value="1" autocomplete="off"/>
			<input type="number" id="symmetric_12" min="-9007199254740992" max="9007199254740992" value="2" autocomplete="off"/>
			<br>
			<input type="number" id="symmetric_21" min="-9007199254740992" max="9007199254740992" value="2" autocomplete="off"/>
			<input type="number" id="symmetric_22" min="-9007199254740992" max="9007199254740992" value="1" autocomplete="off"/>
			<br>
			<input type="number" id="symmetric_31" min="-9007199254740992" max="9007199254740992" value="1" autocomplete="off"/>
			<input type="number" id="symmetric_32" min="-9007199254740992" max="9007199254740992" value="-1" autocomplete="off"/>
			<br>
			<input type="number" id="symmetric_41" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="symmetric_42" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="button" value="Go!" id="symmetric_go_btn" />
		</p>
		<p id="symmetric_output"></p>
		<p>So we're done here, at least for symmetric pieces.</p>
		<p>Credit where credit was due: <a href="https://math.stackexchange.com/a/193942">this answer on the Math StackExchange</a> was a big part of where I got this reasoning from. Also thanks to the SoME3 Discord who helped me figure out that Euclid's algorithm was the key idea.</p>
	</div>
	<div class="content">
		<h2>Asymmetric pieces</h2>
		<p>So now, armed with this Gaussian elimination trick, we come back to asymmetric pieces, with their monoid colorbindings. (Remember that term? It's like a group but doesn't require inverses.) Can we do a similar thing, algorithmically reducing an asymmetric movement set down to a smaller set?</p>
		<p>Well, when we lose symmetry, what in our Gaussian elimination trick fails? One place is obvious: we can't invert a row at will, since the inversion of a row is no longer implied to exist. But another sneakier place is the more fundamental idea that $\{a, b\}$, $\{a, a+b\}$, and $\{a, a-b\}$ all have the same colorbinding. Given a square that you can get to via a sequence of $a$'s and $b$'s, you cannot replace each $b$ with $a+b$ followed by $-a$, because of course $-a$ doesn't exist. For the minus version, you <em>can</em> replace $b$'s with $a-b$ followed by $a$, so we're okay here&mdash;but going the other way doesn't work. If we have a sequence of $a$'s and $a-b$'s that the second piece can do, we cannot replicate it with the first piece's $a$'s and $b$'s.</p>
		<p>With that idea gone, Gaussian elimination is completely out the window. So what other ways are there of reducing a large number of moves to a smaller number? <em>Is</em> there such a way?</p>
		<p>But in fact, no, we cannot. Or at least, not in general, not to something manageable. Because we can construct a piece with any arbitrary number of moves and no way to reduce that moveset down. Consider the piece that can move to $\{(1,1),(1,2),(1,3),(1,4),\ldots, (1,n)\}$, basically jumping to any of the first $n$ spaces in the next column over. This basically just creates rays going out from the origin at slopes $1, 2, 3, 4, \ldots, n$. So obviously any piece with the same colorbinding must only have moves in the "first quadrant" (moves with strictly positive $x$ and $y$ components), since our colorbinding doesn't include anything in the other quadrants. But then, if that's the case, the only way to reach any squares in column $1$ is to jump there directly, since you can't go backwards so you can't overshoot the first column and then come back. So if we have to cover all $n$ squares in the first column, then we have to have all $n$ different moves. <button class='example3'>Asymmetric piece $\{(1,1),(1,2),(1,3),(1,4)\}$</button></p>
		<p>(What would be different if this were a symmetric piece instead? <a href="#custom_reduce">Jump back up to the custom symmetric piece input</a> and try $\{(1,1),(1,2),(1,3),(1,4)\}$ yourself! In fact, also try just $\{(1,1), (1,2)\}$.)</p>
		<p>So then&hellip; what are we even looking for? How can we describe the space of possible asymmetric colorbindings if even irreducible pieces can have an arbitrarily large number of moves in them?</p>
		<p>But unfortunately, here, I really am stuck. It feels like there's a significant structure to these submonoids of the infinite chessboard, but they aren't easily summarized as the symmetric colorbindings, as far as I can tell.</p>
		<p>We can make a few qualitative observations, at least. They're subsets of their symmetric counterparts&mdash;obviously. If an asymmetric piece can get somewhere, then the asymmetric piece can too, by following the same moves. So we're still restricted to a parallelogram grid, but now possibly just a section of it. This is most obvious with something like the Laurel Horse vs. the Narrow Knight <button class='laurelhorse'>Laurel Horse</button> <button class='narrowknight'>Narrow Knight</button>. When you have just two asymmetric moves, it's easy to visualize the resulting colorbinding, because you simply take a wedge of the corresponding symmetric piece's parallelogram grid, the one that sits in between the two moves.</p>
		<p>But with more moves, the parallelogram grid may be something wildly different from any of the original moves, so it's not necessarily immediately obvious what subset we're going to end up with. Consider what happens if you add the move $(1,3)$ to the Laurel Horse/Narrow Knight: <button class='example4'>Asymmetric Piece $\{(1,2), (-1,2), (1,3)\}$</button> <button class='example4_symmetric'>Symmetric Piece $\{(1,2), (-1,2), (1,3)\}$</button>.</p>
		<p>It's likely there are more things you can say about asymmetric colorbindings, but I've had trouble getting anywhere further with this&mdash;I'd love to hear more ideas if you have any. To help, here you can create an arbitrary asymmetric piece with up to twelve moves (and remember you can resize the board, since some of these colorbindings take a bit of space before they get interesting):</p>

		<p id="custom_asymmetric">
			<input type="number" id="asymmetric_11" min="-9007199254740992" max="9007199254740992" value="1" autocomplete="off"/>
			<input type="number" id="asymmetric_12" min="-9007199254740992" max="9007199254740992" value="2" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_21" min="-9007199254740992" max="9007199254740992" value="1" autocomplete="off"/>
			<input type="number" id="asymmetric_22" min="-9007199254740992" max="9007199254740992" value="-1" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_31" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="asymmetric_32" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_41" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="asymmetric_42" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_51" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="asymmetric_52" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_61" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="asymmetric_62" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_71" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="asymmetric_72" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_81" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="asymmetric_82" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_91" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="asymmetric_92" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_101" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="asymmetric_102" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_111" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="asymmetric_112" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="number" id="asymmetric_121" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<input type="number" id="asymmetric_122" min="-9007199254740992" max="9007199254740992" value="0" autocomplete="off"/>
			<br>
			<input type="button" value="Go!" id="asymmetric_go_btn" />
		</p>
		<p id="asymmetric_output"></p>

		<p>But putting asymmetric pieces aside, I do have one last concept to cover, and it brings us right back to group theory.</p>
		<p>Before we move to that, I need to credit <a href="https://math.stackexchange.com/questions/590159/submonoids-of-mathbbnk">another StackExchange answer</a> here, which is about the submonoids of $\mathbb N^2$. It's not exactly the same problem as the asymmetric colorbindings that we're talking about, but it's close enough that I could nab its example. It also talks about a concept which I didn't mention of <strong>finitely generated</strong>. I never actually specified if a piece is allowed to have an infinite number of moves in its moveset, so didn't touch on this.</p>
	</div>
	<div class="content">
		<h2>How many copies of a piece do we need?</h2>
		<p>All right, so back to the much more well-behaved symmetric pieces. We've been starting pieces always from the origin. But in a real game of chess, your two bishops start on different squares. Although no one bishop can visit all squares, the two of them together can visit any square. Ralph Betza on chessvariants.com calls it the <a href="https://www.chessvariants.com/d.betza/pieceval/jacksprat.html">Jack Sprat principle</a>. <button class="bishop">Bishop</button></p>
		<p>But not all pieces require only two pieces to cover the entire board. Obviously, pieces that can cover the entire board like the wazir just need that one piece. Meanwhile, something like the dabbaaba requires four. <button class="wazir">Wazir</button> <button class="dabbaaba">Dabbaaba</button></p>
		<p>The concept we're looking for is called <strong>cosets of a subgroup</strong> in group theory; for our purposes I'll call them <strong>co-colorbindings</strong> (but usually in chess variant talk, they're just also called colorbindings). It's the set of squares that a piece can access starting from <em>any</em> particular square, not just the origin.</p>
		<p>(By the way, this means that the origin isn't in general a part of the set anymore. This is why it's a co<em>set</em> and not a co<em>group</em>, since we no longer have the identity element.)</p>
		<p>It's always true that a group can be partitioned exactly into cosets of one of its subgroup (i.e. the plane can always be partitioned into co-colorbindings of one piece). That is, every element in a group is in exactly one coset of a particular subgroup. That's not necessarily immediately obvious, but it is a true fact from group theory that I won't prove here.</p>
		<p>But our question now is: <strong>if we have a given symmetric piece's colorbinding, how many co-colorbindings does it have?</strong></p>
		<p>Well, remember that we showed above that any symmetric piece can be reduced to an equivalent piece of the form $\{(a,b), (0,d)\}$. So let's consider one example piece and its parallelogram: <button class='example2'>Example symmetric piece $\{(3,3),(0,6)\}$</button>. (Set the board size to at least 18 to see the full parallelogram.) We keep talking about a parallelogram grid with symmetric pieces, and here this shape becomes even more relevant. What I'm showing is kind of the "base" parallelogram of the grid, the one containing the two vectors in our moveset.</p>
		<p>With our original piece, starting from the origin, we cannot hit any of the points on the interior of the parallelogram, only on the corners. So we need more co-colorbinding for the squares on the interior of the parallelogram. I will claim, with the ever-annoying proof of "proof by it's visually obvious," that each square on the interior of the parallelogram needs a <em>different</em> co-colorbinding; no co-colorbinding will cover more than one square inside our parallelogram. So our answer is simply that <strong>the area of the parallelogram is how many co-colorbindings that exist</strong>.</p>
		<p>Because we're working with discrete squares (i.e. $\mathbb Z \times \mathbb Z$), rather than the much more familiar  $\mathbb R \times \mathbb R$, it's not immediately obvious what I mean by the area. I'm including the bottom and left sides of the parallelogram, but not the top or right. With the bottom side at any odd angle depending on the parallelogram, in other cases it's not necessarily clear which tile is or isn't in the interior&mdash; but it doesn't actually matter, as long as we're consistent about it at the top and bottom of the parallelogram (if we include a tile at the bottom, exclude the corresponding tile at the top).</p>
		<p>We can actually take advantage of this arbitrariness to skew the parallelogram into a rectangle by taking tiles off the top and including more tiles on the bottom. So instead of the the aforementioned parallelogram, we can make it into the rectangle from $(0,0)$ to $(3,0)$ to $(3,6)$ to $(0,6)$ <button id='example2_rectangle'>Show rectangle</button>. Every square in there (including the bottom and left, not including the top or right) requires a different co-colorbinding to be accessible. So if we want to Jack Sprat the board with this funny example piece, we would need eighteen distinct copies of the piece. Equivalently, if we want to color the chessboard board according to these co-colorbindings, rather than the co-colorbindings of a bishop, we would need eighteen colors rather than two.</p>
		<p>And this does generalize to other pieces. For any piece that can be reduced to $\{(a,b), (0,d)\}$, it has $a\cdot d$ co-colorbindings. (Why doesn't $b$ matter? Consider again the parallelogram skewing.) Actually, there is one edge case where this isn't true: if $a=0$ or $d = 0$, and the area of the parallelogram is zero. But I'll ignore the degenerate case, and leave that up to you to figure out.</p>
	</div>
	<div class="content">
		<h2>Group-ception: putting co-colorbindings in a group</h2>
		<p>If you'll allow me to abstract these concepts even further before I let you go: the co-colorbindings of a piece themselves form a group. That is, each element of this new meta-group is itself an entire co-colorbinding. This meta-group is called the <strong>quotient group</strong>. Hey, I warned you at the beginning of this paragraph that this was going to be abstract!</p>
		<p>But yes, that's hard to think about, so we usually think about the co-colorbindings as having <strong>representative elements</strong>, and then do all our operations on the representative elements instead, with the understanding that the representative element is a stand-in for the whole group.</p>
		<p>In our case the representative elements are the squares on the "base parallelogram" that we constructed above. So for example, the original colorbinding is also known as the $(0,0)$ co-colorbinding, since it's the co-colorbinding of a piece that starts on the origin. But there's also the $(1,0)$ co-colorbinding, the $(2,0)$ co-colorbinding, the $(2,4)$ co-colorbinding, etc. And if we ever do something that produces a square outside the base rectangle, we can just replace it with the square within the base rectangle in the same co-colorbinding&mdash;that is, the $(3,9)$ co-colorbinding is the same thing as the $(0,0)$ co-colorbinding. (This is a 2D version of modular arithmetic, in case you're familiar with that.)</p>
		<p>You can check the four properties of the group if you want, but I'll take it as a given that this is in fact a well-formed group (this is a result from group theory for all normal subgroups. What "normal" means is beyond the scope of this article, but I'll just say that the colorbindings we're looking at are all normal subgroups). What this means is&hellip; we can do a lot of the same things we just did, but on this meta-group instead! Define "meta-pieces" that move between co-colorbindings rather than between squares.</p>
		<p>This is all fun and abstract, but there is at least one way this can be useful for finding colorbindings. Because instead of needing to deal with the infinite number of squares in $\mathbb Z \times \mathbb Z$, we now have a finite group. We can brute force things a lot more easily now. And moreover, the group loops back on itself, in a modular arithmetic-y kind of way. So those asymmetric pieces that just kind of ran off to infinity before no longer do. They're going to be a lot more well-behaved.</p>
		<p>Of course, we do need to start with a symmetric piece in order to be able to use this "group of co-colorbindings" as a starting point at all. So let's say we have a symmetric piece like this, to which we add a single asymmetric move. What is the colorbinding of the final combined piece? By adding the asymmetric move, we're basically linking up the symmetric co-colorbindings, and putting them together in the same colorbinding.</p>
		<p>For example, add the asymmetric move $(1,3)$ to the example piece we've been working with in this section: <button class='example2'>Original example piece</button> <button class='example2augmented'>Example piece with $\{(1,3)\}$</button>. The co-colorbinding at $(0,0)$ is connected to the co-colorbinding at $(1,3)$, because with this additional asymmetric move you can get to anything in the $(1,3)$ co-colorbinding. But you can also repeat the asymmetric move to connect the $(0,0)$ and $(1,3)$ co-colorbindings to the $(2,6)$ co-colorbinding. And then once more to get to the $(3,9)$ co-colorbinding&mdash;but that's just the same as $(0,0)$ co-colorbinding! So even by only going forward along our asymmetric $(1,2)$ move, we can actually move from any of these three co-colorbindings to any of the others. Our final piece's colorbinding is thus a combination of all three of these co-colorbindings.</p>
		<p>An asymmetric move being added to a symmetric piece is perhaps a fairly specific case, but it's a good way of thinking of the Silver General, at least. It's an asymmetric $(0,1)$ move added to the ferz. The ferz of course only has two co-colorbindings, but this asymmetric move links the two co-colorbindings together, and that's why the Silver General can move to every tile on the board. <button class="silvergeneral">Silver General</button> <button class="ferz">Ferz</button></p>
	</div>
	<div class="content">
		<h2>In conclusion</h2>
		<p>The question we set out to answer, "what are all possible colorbindings of arbitrary leapers?" we found a little bit too difficult to answer completely. We get a very nice answer when we limit ourselves to symmetric leapers: they can always be reduced down to a parallelogram grid generated by just two symmetric moves. And we can use that fact to answer an offshoot question, "how many copies of a symmetric piece do we need to be able to reach the entire board?"</p>
		<p>As for the ever-annoying asymmetric pieces&hellip;it <em>feels</em> like there are a lot more patterns and structure in their colorbindings. But I'm really quite stuck here. Monoids are just not as well-behaved (nor as well-asked about on StackExchange) as groups. Again, if any of you have more ideas, I'd love to hear them.</p>
		<p>But even if it's technically not a complete answer, the ten-year-old in me who still loves looking up chess variants and thinking about symmetries of a chessboard is happy to have any answer at all. This is something I've been thinking about on and off since that time, and it's really cool that the answer touches on so many different math topics: a bit of group theory, a bit of linear algebra, a bit of number theory. And they aren't even necessarily <em>that</em> difficult, but are certainly beyond what a ten-year-old me would have been able to figure out.</p>
		<p>Challenge problem: I didn't talk about <a href="https://www.chessvariants.com/hexagonal.dir/hexagonal.html">hexagonal chess</a> or <a href="https://www.chessvariants.com/3d.dir/3d5.html">3D chess (Raumschach)</a> at all. What do colorbindings look on hex boards and 3D boards?</p>
	</div>

	<hr>
	<h1>Acknowledgments</h1>
	<div class="content">
		<p>This page was created by Viola Buddy for the Summer of Math Exposition 3 (SoME3), an event organized by the YouTube channel 3Blue1Brown (among others) to encourage people to create explanations of math or math-related subjects in any online medium. This page was written in HTML/Javascript, with equations written using the <a href="https://www.mathjax.org/">MathJax</a> library.</p>
		<p>The historical details of chess were derived mostly from Wikipedia and chessvariants.com. But other references include <a href="http://history.chess.free.fr/history.htm">this History of Chess page</a> and <a href="https://www.ancientchess.com/">Ancient Chess</a>. (And these are both webpages with old 1990s-2000s style designs, which is fun.)</p>
	</div>
<script type="text/javascript">
	window.MathJax = {
	  tex: {
	    inlineMath: [['$', '$'], ['\\(', '\\)']]
	  }
	};

	main(document.getElementById('board_size_input').value);
	document.getElementById('board_size_output').innerText = document.getElementById('board_size_input').value;

	for(let thisBtn of document.querySelectorAll('button')) {
		for (let [movementName, movement] of Object.entries(ALL_MOVEMENTS_DICT)) {
			if (!thisBtn.classList.contains(movementName))
				continue;

			thisBtn.addEventListener('click', function(event){
				setPiece(movement, ALL_NAMES_DICT[movementName], ALL_DESCRIPTIONS_DICT[movementName]);
			});
		}
	}

	document.getElementById('customthreemove').addEventListener('click', function(event){
		const array_ids = [
			['customthreemove_11', 'customthreemove_12'],
			['customthreemove_21', 'customthreemove_22'],
			['customthreemove_31', 'customthreemove_32'],
		];
		let movement_array = array_ids.map(row =>
			row.map( id =>
				parseInt(document.getElementById(id).value)
			)
		);
		// check validity
		if (movement_array.some(row =>
				row.some(element =>
					!Number.isInteger(element)
				)
			)) {
			document.getElementById('customthreemove_output').innerHTML = '⚠️ error parsing input ⚠️';
			return;
		}

		// make symmetric
		let movement = movement_array.concat(
				movement_array.map(row => row.map( id => -id))
			);

		setPiece(movement, 'Custom Symmetric Piece', 'Symmetric Piece ' + movesetToString(movement_array));
	});

	document.getElementById('symmetric_go_btn').addEventListener('click', function(event){
		const array_ids = [
			['symmetric_11', 'symmetric_12'],
			['symmetric_21', 'symmetric_22'],
			['symmetric_31', 'symmetric_32'],
			['symmetric_41', 'symmetric_42'],
		];
		let original_movement_array = array_ids.map(row =>
			row.map( id =>
				parseInt(document.getElementById(id).value)
			)
		);
		let movement_array = array_ids.map(row =>
			row.map( id =>
				parseInt(document.getElementById(id).value)
			)
		);
		// check validity
		if (movement_array.some(row =>
				row.some(element =>
					!Number.isInteger(element)
				)
			)) {
			document.getElementById('symmetric_output').innerHTML = '⚠️ error parsing matrix ⚠️';
			return;
		}

		let matrix_4x2_to_latex = function(matrix){
			let output = '\\begin{bmatrix}';

			output += matrix[0][0];
			output += '&';
			output += matrix[0][1];
			output += '\\\\';

			output += matrix[1][0];
			output += '&';
			output += matrix[1][1];
			output += '\\\\';

			output += matrix[2][0];
			output += '&';
			output += matrix[2][1];
			output += '\\\\';

			output += matrix[3][0];
			output += '&';
			output += matrix[3][1];

			output += '\\end{bmatrix}';
			return output;
		};

		/** three elementary row operation functions. Does it in-place, and returns a string.*/
		let swap_rows = function(matrix, r1, r2) {
			[matrix[r1], matrix[r2]] = [matrix[r2], matrix[r1]];

			let output = '\\xrightarrow{\\text{swap rows ' + (r1+1) + ' and ' + (r2+1) + '}} & ';
			output += matrix_4x2_to_latex(matrix);
			output += '\\\\';
			return output;
		}
		let invert_row = function(matrix, r) {
			matrix[r] = matrix[r].map( entry => -entry );

			let output = '\\xrightarrow{\\text{invert row ' + (r+1) + '}} &';
			output += matrix_4x2_to_latex(matrix);
			output += '\\\\';
			return output;
		}
		let subtract_row = function(matrix, r_unchanged, r_changed, numTimes) {
			matrix[r_changed] = matrix[r_changed].map((entry, index) =>
				entry - matrix[r_unchanged][index]*numTimes
			);

			let output = '\\xrightarrow{\\text{subtract row ' + (r_unchanged+1) + ' from row ' + (r_changed+1);
			if (numTimes > 1){
				output += ', ' + numTimes + ' times}} &';
			} else {
				output += '}} &';
			}
			output += matrix_4x2_to_latex(matrix);
			output += '\\\\';
			return output;
		}

		let output = '$$\\begin{aligned}';
		output += matrix_4x2_to_latex(movement_array);

		const NUM_ROWS = 4;
		const NUM_COLS = 2;

		let pivotColumn = 0;
		let pivotRow = 0;
		while (pivotColumn < NUM_COLS) {
			// first, make sure that either the pivot row is nonzero or all relevant rows are zero (in this column)
			if (movement_array[pivotRow][pivotColumn] === 0){
				for (let newPivotRow = pivotRow + 1; newPivotRow < NUM_ROWS; newPivotRow++) {
					if (movement_array[newPivotRow][pivotColumn] !== 0) {
						output += swap_rows(movement_array, pivotRow, newPivotRow);
						break;
					}
				}
				// if even after all that we're still zero, then the entire column is zero
				// skip the rest of the calculation for this column
				if (movement_array[pivotRow][pivotColumn] === 0){
					pivotColumn++;
					continue;
				}
			}

			// swap negatives: row pivotRow
			if (movement_array[pivotRow][pivotColumn] < 0) {
				output += invert_row(movement_array, pivotRow);
			}

			// now do Euclid's algorithm
			for (let r = pivotRow + 1; r < NUM_ROWS; r++ ) {
				// swap negatives: row r
				if (movement_array[r][pivotColumn] < 0) {
					output += invert_row(movement_array, r);
				}
				while(movement_array[pivotRow][pivotColumn] !== 0 && movement_array[r][pivotColumn] !== 0) {
					if (movement_array[pivotRow][pivotColumn] <= movement_array[r][pivotColumn]) {
						let numTimes = Math.floor(movement_array[r][pivotColumn] / movement_array[pivotRow][pivotColumn]);
						output += subtract_row(movement_array, pivotRow, r, numTimes);
					} else {
						let numTimes = Math.floor(movement_array[pivotRow][pivotColumn] / movement_array[r][pivotColumn]);
						output += subtract_row(movement_array, r, pivotRow, numTimes);
					}
				}

				if (movement_array[pivotRow][pivotColumn] === 0) {
					output += swap_rows(movement_array, pivotRow, r);
				}
			}

			pivotRow++;
			pivotColumn++;
		}

		output += '\\end{aligned}$$';

		function onClickOriginalPiece(event) {
			let movement = original_movement_array.concat(
				original_movement_array.map(row => row.map( id => -id))
			);
			setPiece(movement, 'Custom Symmetric Piece', 'Symmetric Piece ' + movesetToString(original_movement_array));
		}
		function onClickReducedPiece(event) {
			let movement = movement_array.concat(
				movement_array.map(row => row.map( id => -id))
			);

			setPiece(movement, 'Reduced Custom Symmetric Piece', 'Symmetric Piece ' + movesetToString(movement_array) +', the reduced version of ' + movesetToString(original_movement_array));
		}
		function onClickShowParallelogram(event) {
			linedraw(parallelogramDivs[0], 0, 0, movement_array[0][0], movement_array[0][1]);
			linedraw(parallelogramDivs[1], movement_array[0][0], movement_array[0][1],
				movement_array[0][0]+movement_array[1][0], movement_array[0][1]+movement_array[1][1]);
			linedraw(parallelogramDivs[3], 0, 0, movement_array[1][0], movement_array[1][1]);
			linedraw(parallelogramDivs[2], movement_array[1][0], movement_array[1][1],
				movement_array[0][0]+movement_array[1][0], movement_array[0][1]+movement_array[1][1]);

			toggleShowParallelogram();
		}

		let output_div = document.getElementById('symmetric_output');
		output_div.innerHTML = '';

		let originalPieceBtn = document.createElement('button');
		originalPieceBtn.innerHTML = 'Custom Piece';
		originalPieceBtn.addEventListener('click', onClickOriginalPiece);
		output_div.appendChild(originalPieceBtn);

		let reducedPieceBtn = document.createElement('button');
		reducedPieceBtn.innerHTML = 'Reduced Piece';
		reducedPieceBtn.addEventListener('click', onClickReducedPiece);
		output_div.appendChild(reducedPieceBtn);

		let showParallelogramBtn = document.createElement('button');
		showParallelogramBtn.innerHTML = 'Show/Hide Parallelogram';
		showParallelogramBtn.addEventListener('click', onClickShowParallelogram);
		output_div.appendChild(showParallelogramBtn);

		let output_div_latex = document.createElement('div');
		output_div_latex.innerHTML = output;
		output_div.appendChild(output_div_latex);

		onClickOriginalPiece();
	});

	document.getElementById('asymmetric_go_btn').addEventListener('click', function(event){
		const array_ids = [
			['asymmetric_11', 'asymmetric_12'],
			['asymmetric_21', 'asymmetric_22'],
			['asymmetric_31', 'asymmetric_32'],
			['asymmetric_41', 'asymmetric_42'],
			['asymmetric_51', 'asymmetric_52'],
			['asymmetric_61', 'asymmetric_62'],
			['asymmetric_71', 'asymmetric_72'],
			['asymmetric_81', 'asymmetric_82'],
			['asymmetric_91', 'asymmetric_92'],
			['asymmetric_101', 'asymmetric_102'],
			['asymmetric_111', 'asymmetric_112'],
			['asymmetric_121', 'asymmetric_122'],
		];
		let movement_array = array_ids.map(row =>
			row.map( id =>
				parseInt(document.getElementById(id).value)
			)
		);
		// check validity
		if (movement_array.some(row =>
				row.some(element =>
					!Number.isInteger(element)
				)
			)) {
			document.getElementById('asymmetric_output').innerHTML = '⚠️ error parsing input ⚠️';
			return;
		}

		// DON'T make symmetric
		let movement = movement_array;

		setPiece(movement, 'Custom Asymmetric Piece', 'Asymmetric Piece ' + movesetToString(movement_array));
	});

	document.getElementById('narrowknightparallelogram').addEventListener('click', function(event) {
		let movement_array = LAURELHORSE;
		linedraw(parallelogramDivs[0], 0, 0, movement_array[0][0], movement_array[0][1]);
		linedraw(parallelogramDivs[1], movement_array[0][0], movement_array[0][1],
			movement_array[0][0]+movement_array[1][0], movement_array[0][1]+movement_array[1][1]);
		linedraw(parallelogramDivs[3], 0, 0, movement_array[1][0], movement_array[1][1]);
		linedraw(parallelogramDivs[2], movement_array[1][0], movement_array[1][1],
			movement_array[0][0]+movement_array[1][0], movement_array[0][1]+movement_array[1][1]);

		toggleShowParallelogram();
	});

	// this getElementsByClassName(...)[0] is hacky but it's too late to care
	document.getElementsByClassName('example2')[0].addEventListener('click', function(event) {
		let movement_array = EXAMPLE2;
		linedraw(parallelogramDivs[0], 0, 0, movement_array[0][0], movement_array[0][1]);
		linedraw(parallelogramDivs[1], movement_array[0][0], movement_array[0][1],
			movement_array[0][0]+movement_array[1][0], movement_array[0][1]+movement_array[1][1]);
		linedraw(parallelogramDivs[3], 0, 0, movement_array[1][0], movement_array[1][1]);
		linedraw(parallelogramDivs[2], movement_array[1][0], movement_array[1][1],
			movement_array[0][0]+movement_array[1][0], movement_array[0][1]+movement_array[1][1]);

		turnOnShowParallelogram();
	});


	document.getElementById('example2_rectangle').addEventListener('click', function(event) {
		let movement_array = [[3,0], [0,6]];
		linedraw(parallelogramDivs[0], 0, 0, movement_array[0][0], movement_array[0][1]);
		linedraw(parallelogramDivs[1], movement_array[0][0], movement_array[0][1],
			movement_array[0][0]+movement_array[1][0], movement_array[0][1]+movement_array[1][1]);
		linedraw(parallelogramDivs[3], 0, 0, movement_array[1][0], movement_array[1][1]);
		linedraw(parallelogramDivs[2], movement_array[1][0], movement_array[1][1],
			movement_array[0][0]+movement_array[1][0], movement_array[0][1]+movement_array[1][1]);

		turnOnShowParallelogram();
	});
	
</script>
</div>


</body>
</html>